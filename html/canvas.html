<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=yes">
  <title>Canvas</title>
</head>

<body>
  <p class="pixel-ratio"></p>
  <canvas></canvas>

  <script>
    const canvas = document.querySelector("canvas");
    var ctx = canvas.getContext("2d");

    // Set display size (css pixels).
    var size = 200;
    canvas.style.width = size + "px";
    canvas.style.height = size + "px";




    function draw() {
      // Set actual size in memory (scaled to account for extra pixel density).
      var scale = window.devicePixelRatio; // Change to 1 on retina screens to see blurry canvas.
      canvas.width = Math.floor(size * scale);
      canvas.height = Math.floor(size * scale);

      // Normalize coordinate system to use css pixels.
      // ctx.scale(scale, scale);

      ctx.fillStyle = "#bada55";
      ctx.fillRect(0, 0, size, size);
      ctx.fillStyle = "#ffffff";
      ctx.font = "18px Arial";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";

      var x = size / 2;
      var y = size / 2;

      var textString = "I love MDN";
      ctx.fillText(textString, x, y);
    }

    let pixelRatioBox = document.querySelector(".pixel-ratio");
    // let mqString = `(resolution: ${window.devicePixelRatio}dppx)`;

    const updatePixelRatio = () => {
      let pr = window.devicePixelRatio;
      let prString = (pr * 100).toFixed(0);
      pixelRatioBox.innerText = `${prString}% (${pr.toFixed(2)})`;
    };

    updatePixelRatio();
    draw();

    // matchMedia(mqString).addEventListener("change", updatePixelRatio);
    window.onresize = () => {
      updatePixelRatio();
      draw();
    }
  </script>
</body>

</html>